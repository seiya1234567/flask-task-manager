# ================================
# Handover Notes
# ================================

## プロジェクト概要
- Flask + SQLAlchemy のタスク管理アプリ
- 認証（登録 / ログイン / ログアウト）実装中
- Docker + Nginx によるコンテナベース構成
- GitHub Flow（main + feature ブランチ運用）

---

## 現在の作業ブランチ
- ブランチ名  
  feature/flask-blueprint-refactor

- 作業概要  
  Blueprint 化および Application Factory パターン導入による  
  アプリ構成のリファクタリング

---

## 本日の対応内容
- auth Blueprint の実装・調整
  - ログイン処理（認証成功 / 失敗）を実装・動作確認
  - ログアウト処理を実装（@login_required 適用）
  - ログイン成功時の遷移先を tasks ページに統一

- tasks Blueprint の実装を進行
  - タスク一覧表示（ログイン後のメインページ）
  - フィルタ機能の実装
  - 新規タスク登録機能の実装
  - 既存タスクの編集・削除機能の実装
  - 各操作に @login_required を適用

- Jinja2 フィルタの整理
  - JST 表示用フィルタ（to_jst）を extensions.py に配置
  - Application Factory（create_app）内でフィルタ登録
  - TemplateAssertionError（No filter named 'to_jst'）の解消を確認

- Blueprint / Application Factory 構成の再確認
  - Blueprint は 1 箇所で生成
  - extensions.py は定義のみとし、循環 import を回避
  - DB 操作時は extensions から db を import する設計を再確認

---

## 実装済み / 確認済み事項
- auth Blueprint
  - ログイン成功時の認証処理
  - ログイン失敗時のエラーハンドリング
  - ログアウト処理の正常動作
- tasks Blueprint
  - タスク一覧表示
  - フィルタ処理
  - 新規作成 / 編集 / 削除の CRUD 操作
- ログイン → tasks ページ遷移 → 各操作 → ログアウトまでの一連の Web 操作が正常動作
- セッション Cookie による認証状態保持を確認
- docker-compose + env-file 構成でのアプリ起動確認
- Blueprint / Factory 構成を維持したまま、認証・タスク管理機能が動作することを確認

---

## 未対応 / 次にやること
- auth Blueprint の整理
  - forms.py（WTForms 導入有無の検討）
  - register（新規登録）機能の実装
- profile Blueprint 実装
  - パスワード変更 / アカウント管理
- Flask-Mail 導入
- MailHog を用いたメール送信・受信確認
- pytest 導入検討（auth / tasks の基本テスト）
- Gunicorn 本番起動コマンドの追加
- feature ブランチ完了後、main へマージ

---

## 起動・確認手順
### Docker 起動
docker compose --env-file env/.env up -d

### アプリ確認
http://localhost:5001  
https://localhost

---

## Git 操作メモ
git status  
git branch  

### コミット & Push
git add .
git commit -m "feat: implement tasks CRUD and login redirect flow"
git push origin feature/flask-blueprint-refactor

---

## 注意点
- .env / env/* / 証明書 / 永続ボリュームは Git 管理外
- main ブランチは常にデプロイ可能な状態を維持
- 作業途中のコードは必ず feature ブランチで管理
- Blueprint は 1 箇所で生成し、import は役割を分ける
- 起動経路は wsgi.py に集約済み
